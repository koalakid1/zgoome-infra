# /init 통합 가이드

Claude Code의 `/init` 명령어와 이 템플릿 규칙 시스템을 함께 사용하는 방법입니다.

---

## 📋 /init 이란?

### Claude Code 기본 기능
```
/init
```

**자동 수행:**
- 프로젝트 구조 분석
- 기술 스택 감지
- **루트에 `CLAUDE.md` 파일 생성** ← 중요!
- 프로젝트 개요 작성

**생성되는 파일:**
- `CLAUDE.md` (프로젝트 루트)

**포함 내용:**
- 프로젝트 설명
- 빌드/테스트 명령어
- 디렉토리 구조
- 아키텍처 설명
- 기술 스택 정보

---

## 🎯 권장 워크플로우

### 옵션 A: /init 사용 후 병합 (권장)

**1. 템플릿 설치**
```
[템플릿 설치] ~/my-project
```

생성됨:
- `.claude/CLAUDE.md.backup` (템플릿 규칙)
- `.claude/info/` (상세 규칙)

**2. /init 실행**
```
/init
```

결과: 루트에 `CLAUDE.md` 생성 (코드베이스 분석 정보)

**3. [덮어쓰기] 명령어로 병합**
```
[덮어쓰기]
```

선택: `2️⃣ 병합`

**최종 결과:**
- `/init`의 코드베이스 분석 정보 (Architecture, Commands 등)
- 템플릿의 규칙 시스템 (`[규칙 추가]`, 태그 등)
- 완벽하게 통합된 CLAUDE.md ✅

### 옵션 B: 템플릿만 사용

**1. 템플릿 설치**
```
[템플릿 설치] ~/my-project
```

**2. 바로 덮어쓰기**
```
[덮어쓰기]
```

선택: `1️⃣ 덮어쓰기`

**3. 프로젝트 정보 수동 입력**

CLAUDE.md 편집:
- 프로젝트명
- 설명
- 기술 스택

**최종 결과:**
- 순수 템플릿 규칙만 포함
- `/init` 없이 사용 가능

---

## 🚀 [덮어쓰기] 명령어 상세

### 명령어

```
[덮어쓰기]
```

### 자동 실행 프로세스

#### 1단계: 파일 확인

- `.claude/CLAUDE.md.backup` 읽기 (템플릿 규칙)
- 루트 `CLAUDE.md` 존재 여부 확인

#### 2단계: 상황 판단 및 선택 제공

**케이스 1: 루트 CLAUDE.md가 있음 (/init으로 생성됨)**
```
🔄 CLAUDE.md 덮어쓰기

📋 현재 상태:
- 템플릿 규칙: .claude/CLAUDE.md.backup ✅
- 루트 CLAUDE.md: 존재함 (/init으로 생성됨)

루트 CLAUDE.md 내용:
  • Architecture
  • Common Commands
  • 코드베이스 구조 설명

선택하세요:
1️⃣ 템플릿으로 완전 덮어쓰기 (기존 내용 삭제)
2️⃣ 병합 (템플릿 규칙 + 기존 코드베이스 정보) ← 권장
3️⃣ 취소

→
```

**케이스 2: 루트 CLAUDE.md가 없음**
```
🔄 CLAUDE.md 생성

📋 현재 상태:
- 템플릿 규칙: .claude/CLAUDE.md.backup ✅
- 루트 CLAUDE.md: 없음

템플릿 규칙을 루트에 복사하시겠습니까?
1️⃣ 예 (CLAUDE.md 생성)
2️⃣ 취소

→
```

#### 3단계: 선택에 따른 처리

**1️⃣ 완전 덮어쓰기:**
```bash
cp .claude/CLAUDE.md.backup CLAUDE.md
```

결과: 순수 템플릿 규칙만 포함

**2️⃣ 병합:**

병합 규칙:
- **템플릿에서 가져올 섹션:**
  - `규칙 추가 프로세스`
  - `프로세스별 필수 참고 문서` (태그)
  - `추가 태그 시스템`
  - `키워드 매칭`

- **기존 CLAUDE.md 처리:**
  1. **프로젝트 정보 섹션**: 기존 것 유지 (있으면)
  2. **코드베이스 분석 섹션** (`Architecture`, `Common Commands` 등):
     - **그대로 CLAUDE.md에 유지** (자동 프롬프팅)
     - 최신 정보 필요 시 `/init` 재실행

병합 결과:
```markdown
# CLAUDE.md (병합 결과)

## 📋 프로젝트 정보
**프로젝트명:** zgoome-infra
**설명:** Kubernetes 인프라 리포지토리
**기술 스택:** Kubernetes, ArgoCD, ...

## Architecture
(/init이 분석한 내용 그대로 유지)

## Common Commands
(/init이 분석한 내용 그대로 유지)

## 🔍 규칙 추가 프로세스
[규칙 추가] {카테고리} - {규칙 내용}
(템플릿에서 추가)

## 🏷️ 프로세스별 필수 참고 문서

### [개발 노트]
- `.claude/info/dev-notes.md` - 알아두면 좋은 것들 (선택적)

(프로젝트별 태그 추가)

## 📌 추가 태그 시스템
(템플릿에서 추가)
```

**선택적 생성: `.claude/info/dev-notes.md`**
```markdown
# 개발자 노트

코드만으로 알기 어려운, 알아두면 좋은 정보들

## 아키텍처 결정 사항 (ADR)

### ArgoCD app-of-apps 패턴 선택
- 이유: ...
- 장점: ...

## 주의사항

### PostgreSQL 백업
- 자동 백업 CronJob은 설정만 되어있음
- 실제 실행은 수동으로 트리거 필요

## 트러블슈팅

### Sealed Secret 재생성 시
- 기존 secret 먼저 삭제
- 그 후 새로 생성

## 유용한 팁

(개발하면서 발견한 것들 자유롭게 추가)
```

**3️⃣ 취소:**
작업 중단

---

## 💡 실제 사용 예시

### 예시 1: zgoome-infra (Kubernetes 프로젝트)

**1. 템플릿 설치**
```
[템플릿 설치] ~/github/zgoome/zgoome-infra
```

**2. /init 실행**
```
/init
```

결과: `CLAUDE.md` 생성됨 (ArgoCD, Kubernetes 구조 분석)

**3. 병합**
```
[덮어쓰기]
→ 2️⃣ 병합
```

**최종 CLAUDE.md 내용:**
```markdown
# CLAUDE.md

## 프로젝트 정보
**프로젝트명:** zgoome-infra
**설명:** Kubernetes 인프라 리포지토리
**기술 스택:** Kubernetes, ArgoCD, ...

## [덮어쓰기] 명령어
(템플릿 규칙)

## Architecture
(/init이 분석한 ArgoCD app-of-apps 구조)

## 규칙 추가 프로세스
[규칙 추가] {카테고리} - {규칙 내용}
(템플릿 규칙)

## Common Commands
(/init이 제공한 kubectl, argocd 명령어)

## 프로세스별 필수 참고 문서
(템플릿 태그 시스템)
```

이제 규칙 추가 가능:
```
[규칙 추가] Kubernetes - manifest는 kustomize로 관리
```

---

## 📝 코드베이스 정보 관리

### CLAUDE.md: /init 정보 유지

**기본 방침:**
- `/init`이 분석한 Architecture, Commands 등은 **CLAUDE.md에 그대로 유지**
- 코드가 변경되면 → `/init` 재실행으로 자동 업데이트
- 수동 관리 불필요 ✅

**최신 정보 유지 방법:**
```
코드 변경 (새 서비스 추가, 구조 변경 등)
↓
/init 재실행
↓
[덮어쓰기] → 2️⃣ 병합
↓
최신 코드베이스 정보 반영 완료
```

### dev-notes.md: 선택적 사용

**코드만으로 알기 어려운 정보만 기록:**

`.claude/info/dev-notes.md` (선택적 생성)
```markdown
# 개발자 노트

## 아키텍처 결정 사항 (ADR)
- 왜 이렇게 설계했는지
- 어떤 트레이드오프가 있었는지

## 주의사항
- 자동화되지 않은 수동 작업
- 알아두면 좋은 함정

## 트러블슈팅
- 자주 겪는 문제와 해결법

## 유용한 팁
- 개발하면서 발견한 것들
```

**언제 사용:**
- ADR (Architecture Decision Record) 필요할 때
- 트러블슈팅 가이드 필요할 때
- 팀 온보딩 자료 필요할 때

**사용하지 않아도 됨:**
- `/init`이 분석할 수 있는 정보
- 코드 보면 알 수 있는 것

---

## ⚠️ 주의사항

### /init은 CLAUDE.md를 덮어씀

`/init`을 여러 번 실행하면 **루트 CLAUDE.md가 덮어써집니다**.

**대응:**
- 템플릿 규칙은 `.claude/CLAUDE.md.backup`에 안전하게 보존됨
- 덮어써져도 `[덮어쓰기]` 명령어로 다시 병합 가능

### 병합은 반복 가능

`[덮어쓰기]` → `2️⃣ 병합`은 언제든 다시 실행 가능:
```
/init (코드베이스 재분석)
[덮어쓰기] → 2️⃣ 병합 (규칙 다시 추가 + 최신 코드베이스 정보)
```

### dev-notes.md는 독립적

선택적으로 사용하는 `dev-notes.md`는:
- `/init`과 무관 (덮어쓰지 않음)
- `[덮어쓰기]`와 무관 (영향 없음)
- 개발자가 자유롭게 관리

---

## 📌 체크리스트

병합 완료 후 확인:

- [ ] `CLAUDE.md`에 프로젝트 정보가 있는가?
- [ ] `CLAUDE.md`에 "[규칙 추가] 프로세스" 섹션이 있는가?
- [ ] `CLAUDE.md`에 "프로세스별 필수 참고 문서" (태그) 섹션이 있는가?
- [ ] `CLAUDE.md`에 `/init`이 분석한 Architecture, Commands 등이 있는가?
- [ ] `.claude/CLAUDE.md.backup` 파일이 보존되어 있는가?
- [ ] `[규칙 추가]` 명령어가 작동하는가?

**선택적:**
- [ ] `.claude/info/dev-notes.md` 파일이 필요한가? (ADR, 트러블슈팅 등)

**지속적 관리:**
- [ ] 코드 변경 시 `/init` 재실행으로 최신 정보 업데이트
- [ ] 새 규칙 추가 시 `.claude/info/`에 체계적으로 저장하고 있는가?

---

**작성일:** 2025-10-07
**용도:** /init과 템플릿 시스템 통합 가이드
